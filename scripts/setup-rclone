#!/bin/bash

##############################################
# rclone Setup Assistant
##############################################

# Colors
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
CYAN='\033[0;36m'
NC='\033[0m'

clear
echo -e "${CYAN}╔══════════════════════════════════════════════════════╗${NC}"
echo -e "${CYAN}║          RCLONE SETUP ASSISTANT                      ║${NC}"
echo -e "${CYAN}╚══════════════════════════════════════════════════════╝${NC}"
echo ""

# Check if rclone installed
if ! command -v rclone &> /dev/null; then
    echo -e "${YELLOW}rclone not found. Installing...${NC}"
    curl https://rclone.org/install.sh | bash
fi

echo -e "${GREEN}rclone Setup Guide${NC}"
echo ""
echo -e "${YELLOW}Popular Remote Storage Options:${NC}"
echo ""
echo "  1. Google Drive (FREE 15GB)"
echo "  2. OneDrive (FREE 5GB)"
echo "  3. Dropbox (FREE 2GB)"
echo "  4. uloz.to (FREE unlimited, but slow)"
echo "  5. MEGA (FREE 20GB)"
echo "  6. AWS S3 (Paid)"
echo "  7. Wasabi (Cheap S3-compatible)"
echo "  8. Backblaze B2 (Cheap)"
echo ""
echo -e "${CYAN}──────────────────────────────────────────────────────${NC}"
echo ""
echo -e "${YELLOW}Recommendation for VPN Backup:${NC}"
echo ""
echo "  Primary  : Google Drive (easy setup, reliable)"
echo "  Secondary: uloz.to or MEGA (free unlimited/large)"
echo ""
echo -e "${CYAN}──────────────────────────────────────────────────────${NC}"
echo ""

read -p "Press Enter to start rclone config..."

# Run rclone config
rclone config

echo ""
echo -e "${GREEN}rclone configuration completed!${NC}"
echo ""
echo -e "${YELLOW}Next steps:${NC}"
echo "  1. Edit /opt/vpn-multi/.env"
echo "  2. Set BACKUP_PRIMARY_REMOTE and BACKUP_SECONDARY_REMOTE"
echo "  3. Test backup with: backup-system profile <profile-name>"
echo ""
echo -e "${CYAN}Example .env configuration:${NC}"
echo ""
echo "  BACKUP_PRIMARY_ENABLED=true"
echo "  BACKUP_PRIMARY_TYPE=\"rclone\""
echo "  BACKUP_PRIMARY_REMOTE=\"gdrive\"        # name you set in rclone config"
echo "  BACKUP_PRIMARY_PATH=\"vpn-backups\""
echo ""
echo "  BACKUP_SECONDARY_ENABLED=true"
echo "  BACKUP_SECONDARY_TYPE=\"rclone\""
echo "  BACKUP_SECONDARY_REMOTE=\"ulozto\"      # name you set in rclone config"
echo "  BACKUP_SECONDARY_PATH=\"vpn-backups\""
echo ""
echo -e "${GREEN}Setup complete!${NC}"
